/* esm.sh - esbuild bundle(openai@4.67.2/_vendor/partial-json-parser/parser) denonext production */
var s={STR:1,NUM:2,ARR:4,OBJ:8,NULL:16,BOOL:32,NAN:64,INFINITY:128,MINUS_INFINITY:256,INF:384,SPECIAL:496,ATOM:499,COLLECTION:12,ALL:511},O=class extends Error{},b=class extends Error{};function A(e,u=s.ALL){if(typeof e!="string")throw new TypeError(`expecting str, got ${typeof e}`);if(!e.trim())throw new Error(`${e} is empty`);return T(e.trim(),u)}var T=(e,u)=>{let N=e.length,t=0,i=r=>{throw new O(`${r} at position ${t}`)},I=r=>{throw new b(`${r} at position ${t}`)},n=()=>(f(),t>=N&&i("Unexpected end of input"),e[t]==='"'?h():e[t]==="{"?p():e[t]==="["?L():e.substring(t,t+4)==="null"||s.NULL&u&&N-t<4&&"null".startsWith(e.substring(t))?(t+=4,null):e.substring(t,t+4)==="true"||s.BOOL&u&&N-t<4&&"true".startsWith(e.substring(t))?(t+=4,!0):e.substring(t,t+5)==="false"||s.BOOL&u&&N-t<5&&"false".startsWith(e.substring(t))?(t+=5,!1):e.substring(t,t+8)==="Infinity"||s.INFINITY&u&&N-t<8&&"Infinity".startsWith(e.substring(t))?(t+=8,1/0):e.substring(t,t+9)==="-Infinity"||s.MINUS_INFINITY&u&&1<N-t&&N-t<9&&"-Infinity".startsWith(e.substring(t))?(t+=9,-1/0):e.substring(t,t+3)==="NaN"||s.NAN&u&&N-t<3&&"NaN".startsWith(e.substring(t))?(t+=3,NaN):y()),h=()=>{let r=t,c=!1;for(t++;t<N&&(e[t]!=='"'||c&&e[t-1]==="\\");)c=e[t]==="\\"?!c:!1,t++;if(e.charAt(t)=='"')try{return JSON.parse(e.substring(r,++t-Number(c)))}catch(a){I(String(a))}else if(s.STR&u)try{return JSON.parse(e.substring(r,t-Number(c))+'"')}catch{return JSON.parse(e.substring(r,e.lastIndexOf("\\"))+'"')}i("Unterminated string literal")},p=()=>{t++,f();let r={};try{for(;e[t]!=="}";){if(f(),t>=N&&s.OBJ&u)return r;let c=h();f(),t++;try{let a=n();Object.defineProperty(r,c,{value:a,writable:!0,enumerable:!0,configurable:!0})}catch(a){if(s.OBJ&u)return r;throw a}f(),e[t]===","&&t++}}catch{if(s.OBJ&u)return r;i("Expected '}' at end of object")}return t++,r},L=()=>{t++;let r=[];try{for(;e[t]!=="]";)r.push(n()),f(),e[t]===","&&t++}catch{if(s.ARR&u)return r;i("Expected ']' at end of array")}return t++,r},y=()=>{if(t===0){e==="-"&&s.NUM&u&&i("Not sure what '-' is");try{return JSON.parse(e)}catch(c){if(s.NUM&u)try{return e[e.length-1]==="."?JSON.parse(e.substring(0,e.lastIndexOf("."))):JSON.parse(e.substring(0,e.lastIndexOf("e")))}catch{}I(String(c))}}let r=t;for(e[t]==="-"&&t++;e[t]&&!",]}".includes(e[t]);)t++;t==N&&!(s.NUM&u)&&i("Unterminated number literal");try{return JSON.parse(e.substring(r,t))}catch{e.substring(r,t)==="-"&&s.NUM&u&&i("Not sure what '-' is");try{return JSON.parse(e.substring(r,e.lastIndexOf("e")))}catch(a){I(String(a))}}},f=()=>{for(;t<N&&` 
\r	`.includes(e[t]);)t++};return n()},U=e=>A(e,s.ALL^s.NUM);export{b as MalformedJSON,O as PartialJSON,U as partialParse};
//# sourceMappingURL=parser.js.map